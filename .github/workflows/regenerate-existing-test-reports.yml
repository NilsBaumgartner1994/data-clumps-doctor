name: "â™»ï¸ Regenerate existing test reports"

on:
  workflow_dispatch:

jobs:
  regenerate:
    name: "â™»ï¸ Regenerate expected test reports"
    runs-on: ubuntu-latest
    steps:
      - name: "ğŸ”„ Checkout repository"
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: "âš™ï¸ Setup Node.js"
        uses: actions/setup-node@v4
        with:
          node-version: "22.16.0"
      - name: "âš™ï¸ Enable Corepack"
        run: corepack enable
      - name: "ğŸ“¦ Install dependencies"
        run: yarn install --immutable
      - name: "ğŸ§ª Regenerate expected reports"
        run: yarn regenerate-existing-test-report-expected
      - name: "ğŸ“¤ Upload regenerated expected reports"
        uses: actions/upload-artifact@v4
        with:
          name: regenerated-expected-test-reports
          path: |
            tests/data-clumps/test-cases/**/report-expected*.json
          if-no-files-found: error
